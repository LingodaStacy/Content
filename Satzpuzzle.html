<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Drag-and-Drop Satzspiel</title>
  <!-- Open Sans einbinden -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      padding: 2em;
      background: #fff;
    }
    .sentence-container {
      margin-bottom: 2em;
      padding: 1em;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #fff;
    }
    .sentence-container h2 {
      margin: 0 0 0.5em;
      font-size: 1.1em;
    }
    .sentence-container p.original {
      margin: 0 0 1em;
      font-weight: bold;
    }
    ul.pool, ul.target {
      list-style: none;
      padding: 0;
      margin: 0.5em 0;
      min-height: 3em;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5em;
    }
    /* Drop-Feld nur Unterstreichung */
    ul.target {
      border: none;
      border-bottom: 2px solid #153BFF;
    }
    li {
      padding: 0.5em 1em;
      background: #153BFF;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: grab;
      user-select: none;
      text-align: center;
    }
    li:active { cursor: grabbing; }
    .action {
      display: inline-flex;
      align-items: center;
      gap: 0.5em;
      margin-top: 0.5em;
    }
    button.check {
      padding: 0.5em 1em;
      font-size: 1em;
      background: #153BFF;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .result {
      display: inline-block;
      min-width: 150px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="game"></div>

  <!-- SortableJS f√ºr Maus & Touch -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script>
    const sentences = [
      ["Der Hund", "l√§uft", "schnell", "√ºber", "die Wiese"],
      ["Die Katze", "schl√§ft", "den ganzen Tag"],
      ["Wir", "gehen", "morgen", "ins Kino"],
      ["Das Wetter", "ist", "heute", "sehr sch√∂n"],
      ["Meine Freunde", "spielen", "Fu√üball", "im Park"]
    ];

    function shuffle(array) {
      const a = array.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    const gameEl = document.getElementById("game");

    sentences.forEach((originalArr, si) => {
      const cont = document.createElement("div");
      cont.className = "sentence-container";

      const title = document.createElement("h2");
      title.textContent = `Satz ${si + 1}`;
      const orig = document.createElement("p");
      orig.className = "original";
      orig.textContent = "Originalsatz: " + originalArr.join(" ");

      const pool = document.createElement("ul"); pool.className = "pool";
      const target = document.createElement("ul"); target.className = "target";
      const btn = document.createElement("button"); btn.className = "check"; btn.textContent = "Pr√ºfen";
      const res = document.createElement("span"); res.className = "result";
      const action = document.createElement("div"); action.className = "action";
      action.append(btn, res);

      cont.append(title, orig, pool, target, action);
      gameEl.appendChild(cont);

      let sortablePool, sortableTarget;

      function load() {
        res.textContent = "";
        pool.innerHTML = "";
        target.innerHTML = "";
        // Teile zuf√§llig anordnen
        const scrambled = shuffle(originalArr);
        scrambled.forEach((text, pi) => {
          const li = document.createElement("li");
          li.textContent = text;
          li.id = `s${si}-p${pi}`;
          pool.appendChild(li);
        });
        // (Re)initialisiere Sortables nach Neu-Laden
        if (sortablePool) sortablePool.destroy();
        if (sortableTarget) sortableTarget.destroy();
        enableDrag();
      }

      function enableDrag() {
        // Pool: verschieben (kein Cloning), kein Put von au√üen, kein internes Sortieren
        sortablePool = Sortable.create(pool, {
          group: { name: 'shared', pull: true, put: false },
          sort: false,
          animation: 150
        });
        // Target: Items aufnehmen und sortieren
        sortableTarget = Sortable.create(target, {
          group: 'shared',
          animation: 150
        });
      }

      btn.addEventListener("click", () => {
        const userOrder = Array.from(target.children).map(li => li.textContent);
        if (userOrder.length !== originalArr.length) {
          res.textContent = "Bitte alle Teile anordnen!";
          res.style.color = "orange";
          return;
        }
        const correct = userOrder.join(" ") === originalArr.join(" ");
        if (correct) {
          res.textContent = "üéâ Richtig! Gut gemacht.";
          res.style.color = "green";
          // Deaktiviere Drag und f√§rbe pink
          sortablePool.option('disabled', true);
          sortableTarget.option('disabled', true);
          target.querySelectorAll('li').forEach(li => li.style.background = "#FF33CC");
        } else {
          res.textContent = "‚ùå Leider falsch. Teile springen in 2 Sek. zur√ºck.";
          res.style.color = "red";
          setTimeout(load, 2000);
        }
      });

      load();
    });
  </script>
</body>
</html>
